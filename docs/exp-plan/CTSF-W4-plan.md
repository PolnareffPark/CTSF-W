# W4 실험, **층 기여도 지도(Shallow/Mid/Deep Cross 제거)** 〔**권장 보완**〕

### 목적

- “**어느 층의 교차가 가장 이득인가?**” → **수용영역·문맥/모양의 깊이별 역할**을 정량화.
    

### 근거(직접 인용)

- Cross‑stitch: “**At each layer** we learn a linear combination ….”(층별 결합의 효과) ([CVF Open Access](https://openaccess.thecvf.com/content_cvpr_2016/papers/Misra_Cross-Stitch_Networks_for_CVPR_2016_paper.pdf?utm_source=chatgpt.com "Cross-Stitch Networks for Multi-Task Learning"))
    

### 모델 조작

- **Shallow‑only / Mid‑only / Deep‑only** 교차 남기고 나머지 OFF(양방향 유지).
    
- HP2 동일.
    

### 평가·통계/판정

- 각 조건의 ΔRMSE, ΔTOD, Δ피크/시차.
    
- **ETTm2**는 **Deep 쪽 교차**가, **ETTh2**는 **Shallow/Mid 쪽 교차**가 상대적으로 클 가능성(가설) — 결과로 **층별 설계 가이드** 제시.

---

W4 실험 – 교차 층 기여도 분석 (Shallow/Mid/Deep)
[배경 및 필요성]: 교차 연결이 어느 계층에서 가장 이득을 주는가? 하는 질문은 모델 설계 최적화에 중요합니다. 만약 특정 층의 교차만으로도 충분하다면 모델을 단순화할 수 있고, 반대로 특정 층의 교차는 불필요하다면 제거를 고려할 수 있습니다. W4 실험은 얕은 층, 중간 층, 깊은 층 교차 연결 중 어떤 부분이 성능에 기여하는지 파악하여 설계 가이드라인을 얻고자 합니다. 이는 Cross-Stitch 논문의 “각 층마다 효과가 다르다”는 언급과도 관련됩니다[8].
[실험 목적]: Shallow-only, Mid-only, Deep-only 교차 연결 모델들을 만들어 비교합니다. 즉, 세 가지 실험: - 얕은 초기 몇 개 층에만 교차 연결을 남기고 이후 모두 OFF - 중간 일부 층에만 교차 ON - 가장 깊은 몇 개 층에만 교차 ON 각 경우 성능 변화를 측정하여, 어느 부분의 교차가 가장 효과적인지 알아냅니다. 이를 통해 CTSF 모델의 교차 설계 최적화에 대한 통찰을 얻습니다.
[이론적 근거]: Cross-Stitch Networks에서도 “At each layer... (층별 결합의 효과)”를 강조했지만, 실제로는 작업에 따라 최적 층이 다를 수 있음을 보여준 바 있습니다[27][28]. 우리의 경우도 데이터 특성에 따라 얕은 층(저수준 특징) vs 깊은 층(고수준 추세) 중 어디서 결합하는 게 유리한지 다를 수 있습니다. 가설적으로: - ETTm2(15분간격, 변동 많음): 깊은 층 교차가 더 중요할 수 있음 – 장기 추세를 잡아가는 후반에서 교차해야 효과적. - ETTh2(1시간간격, 주기 뚜렷): 얕은/중간 층 교차가 중요 – 초반에 계절성 등 신호를 같이 학습시키는 게 도움.
이러한 가설을 실험으로 검증하려는 것입니다.
[모델 조작]: - Shallow-only: 예를 들어 4개 블록 중 1~2층에만 교차 ON, 3~4층은 교차 OFF. - Mid-only: 2~3층에만 ON, 나머지 OFF. - Deep-only: 마지막 1~2개 층(예: 3~4층)에만 ON, 앞부분 OFF. - (정확한 구분은 전체 층 수에 따라 조정; CTSF 기본이 4개 block이라 가정) - 모두 양방향 교차는 유지 (ON 되는 층에서는 GRU→CNN, CNN→GRU 둘 다 활성). HP2 동일 적용.
[평가 및 분석]: - 각 조건별 RMSE, MAE를 기본 모델(both all-layer)과 비교하여 성능 감소량을 평가합니다. 어느 조건에서 감소가 가장 적은지가 중요 포인트입니다. - TOD 지표, 피크/시차 지표도 계산하여, 예컨대 얕은 층 교차만 있을 때 vs 깊은 층 교차만 있을 때 어떤 지표가 더 유지되는지를 봅니다. - 분석 초점: ETTm2에서 deep 교차만 남겨도 성능이 괜찮다면 deep쪽이 핵심, 반면 ETTh2에서는 shallow 쪽이 핵심… 등의 패턴을 찾습니다. - 통계적으로 RMSE 차이를 95% 신뢰구간으로 비교하고, 유의한 차이면 언급합니다.
•	판정 기준:
•	한 조건에서만 성능이 현저히 낮다면, 그 부분의 교차가 매우 중요하다는 뜻입니다.
•	예를 들어 ETTm2에서 Deep-only가 다른 조건보다 월등히 나으면 “깊은 층 교차 기여도가 크다”라고 판정.
•	ETTh2에서 Shallow-only가 좋으면 “초기 교차 중요” 판정.
•	만약 all-layer보다 특정 조건이 더 좋다면 (가능성은 낮지만) 불필요한 교차가 있었다는 의미도 될 수 있습니다.
[기대 해석]: - 예상대로라면, ETTm2 (여러 주기, 불규칙 변동 혼합)에서는 후반부 교차가 GRU의 장기 추세와 CNN의 누적패턴을 맞춰주는 역할로 중요할 것입니다. 반면 ETTh2 (명확한 일/주기)에서는 초~중반 교차로 기본 패턴을 함께 학습하는 게 더 중요할 수 있습니다. - 이 결과는 새로운 데이터에 모델 적용 시 교차를 어디에 배치/집중해야 할지 지침을 줍니다. 예컨대 “데이터에 강한 계절성 → 얕은 층부터 특성 결합 강화”, “데이터 변동 잦음 → 후반 교차 강화” 등으로 응용 가능할 것입니다. - 또한, 불필요한 교차가 있다면 해당 부분은 모델 단순화를 통해 경량화할 수 있는 여지가 있습니다.
[보고 형식]: - 표: 데이터셋별로 Shallow-only, Mid-only, Deep-only의 RMSE 및 주요 지표를 baseline과 함께 나열해 한눈에 비교. - 그래프: 라인 차트로 층별 교차 개수(혹은 위치)에 따른 성능 변화를 나타냅니다. 예: x축 = 교차 적용 범위(얕은→깊은), y축 = RMSE (낮을수록 좋음), 곡선 형태로 최적 범위를 식별.
